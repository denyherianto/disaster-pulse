Build a production-grade full-stack application using latest version of Next.js (App Router) with TypeScript in (/Users/denyherianto/Developer/Projects/disaster-pulse), where API Routes implement the backend and React Server/Client Components implement the frontend (using REF.html as the UI reference), strictly following all rules and references defined in AGENTS.md and its authoritative specs (DATABASE_SCHEMA.md, DATA_LIFECYCLE.md, INCIDENT_STATE_MACHINE.md, INCIDENT_THRESHOLDS.md, EVIDENCE_WEIGHTING.md, CONFIDENCE_DECAY.md) in specs folder; use Supabase (PostgreSQL + PostGIS) as the primary database with all credentials and keys loaded from .env.local (e.g. SUPABASE_URL, SUPABASE_ANON_KEY, SUPABASE_SERVICE_ROLE_KEY), implement a centralized Supabase client for server and client contexts, ingest immutable raw signals, cluster them by city and time, derive multiple incidents per cluster, manage incident.confidence_score, incident.severity, and incident.status as orthogonal concepts, expose efficient map-viewport queries and incident detail APIs, run background jobs for clustering, AI (Gemini) evaluation, decay, and notification dispatch, trigger notifications only on incident state transitions, evaluate proximity against user_places (not passive tracking), persist decisions not message content, log all lifecycle transitions for auditability, and ensure AI is used solely to organize, summarize, and explain evidence—never to make alert decisions—while treating privacy, explainability, and long-term trust as first-class constraints across the entire stack.
